// data begin
  var initialLocation = [
        {
            "states": "DC",
            "position": {lat:38.916554, lng:-77.025977},
            "description": "Over 200,000 African-American soldiers and sailors served in the U.S. Army and Navy during the Civil War. Their service helped to end the war and free over four million slaves. The African American Civil War Memorial honors their service and sacrifice.",
            "designation": "",
            "parkCode": "afam",
            "id": "1A47416F-DAA3-4137-9F30-14AF86B4E547",
            "directionsInfo": "The memorial is located at the corner of Vermont Avenue, 10th St, and U Street NW, near the U Street/African-American Civil War Memorial/Cardozo Metro Station.",
            "directionsUrl": "http://www.nps.gov/afam/planyourvisit/directions.htm",
            "fullName": "African American Civil War Memorial",
            "url": "https://www.nps.gov/afam/index.htm",
            "weatherInfo": "Washington DC gets to see all four seasons. Humidity will make the temps feel hotter in summer and colder in winter.\n\nSpring (March - May) Temp: Average high is 65.5 degrees with a low of 46.5 degrees\n\nSummer (June - August) Temp: Average high is 86 degrees with a low of 68.5 degrees\n\nFall (September - November) Temp: Average high is 68 degrees with a low of 51.5 degrees\n\nWinter (December - February) Temp: Average high is 45 degrees with a low of 30 degrees\n\n(Source: www.usclimatedata.com)",
            "name": "African American Civil War Memorial"
        },
   
        {
            "states": "DC",
            "position": {lat:38.89231541, lng:-77.00381882},
            "description": "Home to the National Woman's Party for nearly 90 years, this was the epicenter of the struggle for women's rights. From this house in the shadow of the U.S. Capitol and Supreme Court, Alice Paul and the NWP developed innovative strategies and tactics to advocate for the Equal Rights Amendment and equality for women. President Barack Obama designated the national monument on April 12, 2016.",
            "designation": "National Monument",
            "parkCode": "bepa",
            "id": "E7E4E103-5FA9-45AC-8843-05DE554CDBB7",
            "directionsInfo": "The Belmont-Paul Women's Equality NM is located on Capitol Hill at the corner of Constitution Avenue and 2nd Street, NE, next to the Hart Senate Office building. It is a free-standing, federal style brick house surrounded by a black cast-iron fence.\nThe entrance for museum tours and the museum shop is located on 2nd Street with the lift accessible entrance located to the side of the museum next to the Hart Senate Office Building. The doors facing Constitution Avenue are not entrances.",
            "directionsUrl": "http://www.nps.gov/bepa/planyourvisit/directions.htm",
            "fullName": "Belmont-Paul Women's Equality National Monument",
            "url": "https://www.nps.gov/bepa/index.htm",
            "weatherInfo": "Washington DC gets to see all four seasons. Humidity will make the temps feel hotter in summer and colder in winter. Spring (March - May) Temp: Average high is 65.5 degrees with a low of 46.5 degrees Summer (June - August) Temp: Average high is 86 degrees with a low of 68.5 degrees Fall (September - November) Temp: Average high is 68 degrees with a low of 51.5 degrees Winter (December - February) Temp: Average high is 45 degrees with a low of 30 degrees (Source: www.usclimatedata.com)",
            "name": "Belmont-Paul Women's Equality"
        },
       
        {
            "states": "DC",
            "position": { lat:38.86298458, lng:-76.98508147},
            "description": "Frederick Douglass spent his life fighting for justice and equality. Born into slavery in 1818, he escaped as a young man and became a leading voice in the abolitionist movement. People everywhere still find inspiration today in his tireless struggle, brilliant words, and inclusive vision of humanity. Douglass's legacy is preserved here at Cedar Hill, where he lived his last 17 years.",
            "designation": "National Historic Site",
            "parkCode": "frdo",
            "id": "F6831504-A456-45C8-B87B-0FCE1D849A12",
            "directionsInfo": "The site can be reached by car, public transportation, or on foot. See the directions page of the website for more detailed information.",
            "directionsUrl": "http://www.nps.gov/frdo/planyourvisit/directions.htm",
            "fullName": "Frederick Douglass National Historic Site",
            "url": "https://www.nps.gov/frdo/index.htm",
            "weatherInfo": "Winter: Temperatures usually range from 30 to 50 F. There is occasional snow.\n\nSpring: Temperatures usually range widely from 40 to 70 F. Rain is common.\n\nSummer: Temperatures usually range from 70 to 90 F. Humidity is usually high. Be prepared and drink plenty of water. There is a water fountain in the visitor center.\n\nFall: Temperatures usually range widely from 40 to 70 F. Humidity can remain high in the earlier part of the season.",
            "name": "Frederick Douglass"
        },
       
        {
            "states": "DC",
            "position": { lat:38.88784226, lng:-77.04773857},
            "description": "Our nation honors her sons and daughters who answered the call to defend a country they never knew and a people they never met.",
            "designation": "",
            "parkCode": "kowa",
            "id": "0DEA542F-01B7-4631-8AAD-124161D7B7E6",
            "directionsInfo": "GPS Coordinates: 38.887778, -77.047660\nAddress: 10 Daniel French Dr, SW, Washington, D.C.\nNearest Intersection: Independence Ave. & Daniel Chester French Dr. SW",
            "directionsUrl": "http://www.nps.gov/kowa/planyourvisit/directions.htm",
            "fullName": "Korean War Veterans Memorial",
            "url": "https://www.nps.gov/kowa/index.htm",
            "weatherInfo": "Washington DC gets to see all four seasons. Humidity will make the temps feel hotter in summer and colder in winter.\n\nSpring (March - May) Temp: Average high is 65.5 degrees with a low of 46.5 degrees\n\nSummer (June - August) Temp: Average high is 86 degrees with a low of 68.5 degrees\n\nFall (September - November) Temp: Average high is 68 degrees with a low of 51.5 degrees\n\nWinter (December - February) Temp: Average high is 45 degrees with a low of 30 degrees\n\n(Source: www.usclimatedata.com)",
            "name": "Korean War Veterans Memorial"
        },
        {
            "states": "DC",
            "position": { lat:38.88927229, lng:-77.05017778},
            "description": "\"In this temple, as in the hearts of the people for whom he saved the Union, the memory of Abraham Lincoln is enshrined forever.\" Beneath these words, the 16th President of the United States sits immortalized in marble as an enduring symbol of unity, strength, and wisdom.",
            "designation": "",
            "parkCode": "linc",
            "id": "1EAEF5FA-8CD4-40D7-8B09-07F20E3E5AA5",
            "directionsInfo": "GPS Coordinates: 38.889321, -77.050166\nAddress: 2 Lincoln Memorial Circle, NW, Washington, D.C.\nNearest Intersection: Independence Ave. SW & Daniel Chester French Dr. SW",
            "directionsUrl": "http://www.nps.gov/linc/planyourvisit/directions.htm",
            "fullName": "Lincoln Memorial",
            "url": "https://www.nps.gov/linc/index.htm",
            "weatherInfo": "Washington DC gets to see all four seasons. Humidity will make the temps feel hotter in summer and colder in winter.\n\nSpring (March - May) Temp: Average high is 65.5 degrees with a low of 46.5 degrees\n\nSummer (June - August) Temp: Average high is 86 degrees with a low of 68.5 degrees\n\nFall (September - November) Temp: Average high is 68 degrees with a low of 51.5 degrees\n\nWinter (December - February) Temp: Average high is 45 degrees with a low of 30 degrees\n\n(Source: www.usclimatedata.com)",
            "name": "Lincoln Memorial"
        },
        
        {
            "states": "DC",
            "position": { lat:38.85301412, lng:-76.98495791},
            "description": "Welcome to National Capital Parks-East. We invite you to journey to parks Beyond the Capital of Washington, D.C.  National Capital Parks-East is 13 park sites, parkways and statuary covering more than 8,000 acres of historic, cultural, and recreational parklands from Capitol Hill to the nearby Maryland suburbs",
            "designation": "",
            "parkCode": "nace",
            "id": "BA3C1A1D-AA6A-49EB-9237-0222CEEE2670",
            "directionsInfo": "DC295 South to the Exit for I-694/I-395/Capitol Hill then a left Exit 4B to 11th St SE/MLK Jr Ave.  Turn Left at light onto 11st/MLK JR. **\n\nI-295 North to Exit 4B to 11th St SE/MLK Jr Ave.  Turn Right at the light.  **\n\nFrom downtown DC: I-395 to I-695/SW Freeway, take Exit 1C 11th St SE. Turn Right onto 11th St **\n\n** At the  light turn Right onto Good Hope Road.  At the Stop Sign turn Left.  Turn Left at the next road way.",
            "directionsUrl": "http://www.nps.gov/nace/planyourvisit/directions.htm",
            "fullName": "National Capital Parks-East",
            "url": "https://www.nps.gov/nace/index.htm",
            "weatherInfo": "Summers are generally hot and humid, with daytime highs frequently above 90 degrees Fahrenheit and scattered afternoon thunderstorms. \nWinters are generally cold, with nighttime lows frequently near freezing and occasional snowfall. \nWeather during spring and fall is generally moderate, but can change quickly.",
            "name": "National Capital Parks-East"
        },
        
        {
            "states": "DC",
            "position": { lat:38.88101431, lng:-77.03632572},
            "description": "Author of the Declaration of Independence, Statesman and Visionary for the founding of a Nation.",
            "designation": "",
            "parkCode": "thje",
            "id": "2D0C31DF-BE78-42A8-812E-1A44602B3D40",
            "directionsInfo": "GPS Coordinates: 38.881387, -77.036508\n\nThomas Jefferson Memorial is part of the National Mall and Memorial Parks. The site lies at the southern end of the National Mall, adjacent to the Tidal Basin in West Potomac Park. The memorial rests within the sightline to and from the White House, which stands one mile to the north.",
            "directionsUrl": "http://www.nps.gov/thje/planyourvisit/directions.htm",
            "fullName": "Thomas Jefferson Memorial",
            "url": "https://www.nps.gov/thje/index.htm",
            "weatherInfo": "Washington DC gets to see all four seasons. Humidity will make the temps feel hotter in summer and colder in winter.\n\nSpring (March - May) Temp: Average high is 65.5 degrees with a low of 46.5 degrees\n\nSummer (June - August) Temp: Average high is 86 degrees with a low of 68.5 degrees\n\nFall (September - November) Temp: Average high is 68 degrees with a low of 51.5 degrees\n\nWinter (December - February) Temp: Average high is 45 degrees with a low of 30 degrees\n\n(Source: www.usclimatedata.com)",
            "name": "Thomas Jefferson Memorial"
        },

    ]
// data end

// Model: Blueprint for KO Location objects
var Location = function(data){
    this.name = ko.observable(data.name);
    // Create marker for each location
    this.marker = new google.maps.Marker({
        map: map,
        position: data.position,
        name: data.name,
        directionsUrl: data.directionsUrl,
        description: data.description,
        states: data.states,
        animation: google.maps.Animation.DROP,
    });
}



// ViewModel: Controls interaction between Model and View
var ViewModel = function(){
    var self = this;
    this.locationList = ko.observableArray([]);
    //for the dropdown list
    this.selectedLocation = ko.observable();

    this.selectionChange = function() {
        self.clickListShowMarker(self.selectedLocation());
        
    }

    initialLocation.forEach(function(listItem){
        
        // Create new Locatioin from listItem
        var newLoc = new Location(listItem);

        // Add listener to marker
        newLoc.marker.addListener('click', function(){
            self.clickListShowMarker(newLoc);
            newLoc.marker.setIcon('https://www.google.com/mapfiles/marker_green.png');
<<<<<<< HEAD
            
=======
       
>>>>>>> fd049d77a6ea03fe009071c7e39ad7a64c0def06
        });
        

        // Push Location to locationList
        self.locationList.push(newLoc);
        
    });

    
    var infowindow = new google.maps.InfoWindow({
        maxWidth: 400,
        });

    this.clickListShowMarker = function(location) {
        location.marker.setIcon('https://www.google.com/mapfiles/marker_green.png');
      

// Flickr API

//  var $body = $('body');
       var flickrUrl="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=c9dc37eeb28fc5b376222e989a04c75e&text="+ location.marker.name +"&per_page=5&page=1&format=json";     
        var contentString = "";

        var flickrRequestTimeout = setTimeout(function(){
            contentString = "failed to get Flickr resources";
    }, 10000);

    $.ajax({
        url: flickrUrl,
        dataType:"jsonp",
        jsonp: 'jsoncallback',
        success:function(response)
        {
            var articlrList=response.photos.photo;
<<<<<<< HEAD
               
            var farmid = articlrList[0].farm;
            var serverid = articlrList[0].server;
            var photoid = articlrList[0].id;
            var secret = articlrList[0].secret;
            var url = 'https://farm' + farmid + '.staticflickr.com/' + serverid + '/' + photoid + '_' + secret + '.jpg';   
  
=======
                // var url = 'https://farm' + farm + '.staticflickr.com/' + server + '/' + id + '_' + secret + '.jpg';
            for(var i=0;i<5;i++)
            {
                console.log(articlrList[i].farm);
                var farmid = articlrList[i].farm;
                var serverid = articlrList[i].server;
                var photoid = articlrList[i].id;
                var secret = articlrList[i].secret;
                var url = 'https://farm' + farmid + '.staticflickr.com/' + serverid + '/' + photoid + '_' + secret + '.jpg';
        }
>>>>>>> fd049d77a6ea03fe009071c7e39ad7a64c0def06
            window.url = url;
            clearTimeout(flickrRequestTimeout);
    }

   });

 //Wikipedia AJAX request 
    var wikiUrl = 'http://en.wikipedia.org/w/api.php?action=opensearch&search=' + location.marker.name + '&format=json&callback=wikiCallback';
    // var contentString = '<div id="exo" class="jumbotron"><h3>'+ location.marker.name+'</h3><b>State:  '+ location.marker.states+'</b><br><p>'+ location.marker.description+'</p><br>' ;
     contentString += '<div class="jumbotron" id="exo"><h4>'+ location.marker.name+'</h4><b>State:  '+ location.marker.states+'</b><br><p>'+ location.marker.description+'</p><br>' ;
     contentString += "<img src='" + window.url + "'\><br><br>";
    
    var wikiRequestTimeout = setTimeout(function(){
        contentString = "failed to get wikipedia resources";
    }, 10000);

    console.log(contentString);
    $.ajax({
        url: wikiUrl,
        dataType: "jsonp",
        jsonp: "callback",
        success: function(response){
            var articleList = response[2];
            
            console.log(response);
            var url = response[3][0];
            var articleStr = response[2][0];
            if (articleStr === "") {
                articleStr = "Read more on Wikipedia.";
            }
            contentString += '<a class="btn btn-info btn-sm" href="'+url+'"><i class="fa fa-wikipedia-w" aria-hidden="true"></i>  Wikipedia</a>&nbsp;&nbsp;<a class="btn btn-success btn-sm" href="'+ location.marker.directionsUrl+'"><i class="fa fa-map-pin" aria-hidden="true"></i>  Visit</a></div>';

            infowindow.setContent(contentString);
            map.setCenter(location.position);
            infowindow.open(map, location.marker);
            // map.setZoom(14);
            clearTimeout(wikiRequestTimeout);
        }

    });

    }

}

// Initialize and setup google map
var map;
var marker;
function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
        zoom: 13,
        center: {lat:38.8888816, lng:-77.0106309},
    });
    ko.applyBindings(new ViewModel());
}
